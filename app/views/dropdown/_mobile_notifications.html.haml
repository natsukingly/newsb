
.mobile_ddm_header.mobile_notification_ddm
	.mobile_ddm_header_wrapper
		%h2.mobile_ddm_title
			=t ('dropdown.notifications')
		.close_mobile_ddm_btn
			=render 'svg/close_icon'

-if current_user
	.mobile_notification_ddm.ddm.mobile_ddm
		.mobile_notification_ddm_wrapper.ddm_wrapper
			.notifications.notification_list_for_ddm.mobile_notifications
				-if current_user.notifications.empty?
					.notification_empty
						You haven't received any notifications yet.
				-else        
					=render @notifications
					-if @notifications.count < 30
						.scroll_btn.stop_loading
							=t ('scroll.no_more')	
					-else
						.scroll_btn.mobile_notifications
							=t ('scroll.load')	
						


:javascript
	$('.scroll_btn.mobile_notifications').click(function(e){
		e.stopPropagation();
		var stop_loading = $(this).hasClass('stop_loading');
		console.log($('.notifications').find('.notification').length);
		if(!(stop_loading)){
			$.ajax({
				url: "#{load_mobile_notifications_path}",
				type: "GET",
				data: {existing_notifications: $('.mobile_notifications').find('.notification').length,
				},
				dataType: 'script',
			});
			$(this).html("<i class='fa fa-spinner fa-pulse'></i>");
			$(this).addClass("loading");
		}
	});